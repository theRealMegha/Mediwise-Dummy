<div class="space-y-4">
    <h4 class="font-bold text-slate-800 text-lg mb-4">Prescriptions for {{ patient.first_name }} {{ patient.last_name }}</h4>
    
    {% if prescriptions %}
        {% for prescription in prescriptions %}
            <div class="group p-4 bg-white/50 hover:bg-white rounded-2xl border border-transparent hover:border-blue-100 hover:shadow-md hover:shadow-blue-500/5 transition-all duration-300">
                <div class="flex items-start justify-between">
                    <div class="flex-1">
                        <h5 class="font-bold text-slate-800 mb-3">Prescription - {{ prescription.created_at|date:"M d, Y" }}</h5>
                        
                        {% for medicine in prescription.medicines.all %}
                        <div class="mt-3 p-3 bg-blue-50 rounded-lg border border-blue-100">
                            <div class="flex justify-between items-start">
                                <div>
                                    <div class="font-bold text-slate-800">{{ medicine.drug_name_generic }}</div>
                                    {% if medicine.drug_name_brand %}
                                        <div class="text-sm text-slate-600">({{ medicine.drug_name_brand }})</div>
                                    {% endif %}
                                    <div class="mt-1 text-sm">
                                        <span class="text-slate-700">Strength:</span> 
                                        <span class="text-slate-600">{{ medicine.strength }}</span>
                                    </div>
                                    <div class="text-sm">
                                        <span class="text-slate-700">Dosage:</span> 
                                        <span class="text-slate-600">{{ medicine.dosage_frequency }}</span>
                                    </div>
                                    <div class="text-sm">
                                        <span class="text-slate-700">Route:</span> 
                                        <span class="text-slate-600">{{ medicine.route_administration }}</span>
                                    </div>
                                    <div class="text-sm">
                                        <span class="text-slate-700">Quantity:</span> 
                                        <span class="text-slate-600">{{ medicine.total_quantity }}</span>
                                    </div>
                                    <div class="mt-1 text-sm text-slate-600">
                                        <strong>Duration:</strong> {{ medicine.duration_course }}
                                    </div>
                                    {% if medicine.instructions %}
                                    <div class="mt-2 text-sm text-slate-700 italic">
                                        "{{ medicine.instructions }}"
                                    </div>
                                    {% endif %}
                                </div>
                                {% if not forloop.last %}
                                <div class="text-xs text-slate-400 ml-2">+{{ prescription.medicines.count|add:'-1' }} more medicines</div>
                                {% endif %}
                            </div>
                        </div>
                        {% empty %}
                        <div class="mt-3 p-3 bg-yellow-50 rounded-lg border border-yellow-100">
                            <div class="text-sm text-yellow-700">No medicines recorded for this prescription</div>
                        </div>
                        {% endfor %}
                        
                        {% if prescription.next_appointment_date %}
                        <div class="mt-3 text-sm text-blue-600 font-medium">
                            <i class="fas fa-calendar-check mr-1"></i>
                            Next Appointment: {{ prescription.next_appointment_date|date:"M d, Y" }}
                        </div>
                        {% endif %}
                    </div>
                    <div class="flex flex-col items-end gap-1">
                        <span class="text-[10px] uppercase tracking-wider font-semibold text-slate-500">
                            {{ prescription.created_at|date:"M d, Y" }}
                        </span>
                        
                        <button onclick="prescribeAgain('{{ prescription.id }}')" 
                                class="inline-flex items-center px-3 py-1.5 bg-blue-600 text-white text-xs font-semibold rounded-md hover:bg-blue-700 active:scale-95 transition-all shadow-sm">
                            <i class="fas fa-redo-alt mr-1.5 text-[10px]"></i> 
                            Prescribe Again
                        </button>
                    </div>
                </div>
            </div>
        {% endfor %}
    {% else %}
        <div class="text-center py-8">
            <i class="fas fa-prescription-bottle text-3xl text-slate-300 mb-4"></i>
            <p class="text-slate-500">No prescriptions found for this patient.</p>
        </div>
    {% endif %}
</div>